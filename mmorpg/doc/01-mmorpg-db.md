# 1. MMORPG DB: Cuenta, Jugador, Personaje

_12-04-2008_ _Juan Mellado_

Aunque normalmente se utilice cualquiera de las tres palabras que aparecen en el título de este artículo para referirse a una misma cosa, sobre todo las dos primeras, en realidad son bastante distintas.

**Cuenta** es la entidad que se crea en el momento que una persona decide suscribirse a un juego, o a una serie de ellos, habitualmente a través de un portal _web_. La información característica asociada la componen los datos de carácter personal que se suministran tradicionalmente en el momento de la apertura, como por ejemplo un dirección de correo o una contraseña. Si además el disfrute del juego requiere la realización de algún tipo de pago, entonces habría que añadir el nombre, dirección, y algún tipo de información de tipo económico que permita realizar la facturación correspondiente.

Un detalle interesante acerca de las cuentas reside en el hecho de que nunca se utilizarán durante el desarrollo de una partida, a excepción quizás del _login_ de usuario (otra palabra más para referirse a una misma cosa). Cualquier tipo de consulta o proceso, como por ejemplo el cálculo de la facturación mensual, debería poder ejecutarse sin afectar al desarrollo del juego. Para conseguir este propósito lo mejor es mantener toda esta información es un esquema propio separado del que almacene el estado del mundo en el juego. Esa separación podría ser incluso física, es decir, mantenerse en servidores distintos.

**Jugador** es una instancia de una cuenta que se utiliza en el momento que se accede a un juego. En un principio podría pensarse en tratar las cuentas y los jugadores como una misma cosa, pero mantenerla separadas tiene sus ventajas, como por ejemplo permitir varios juegos para una misma cuenta, e incluso varios jugadores para una misma cuenta. La información propia de un jugador sería la generada a partir del uso que haga de cada juego, como por ejemplo la fecha y dirección IP de su última conexión.

Lo importante es que cuenta y jugador se mantengan sincronizados de algún modo lógico. En una base de datos relacional la mejor forma de conseguirlo es mediante el uso de _foreign keys_ (claves foráneas). Es decir, el identificador de cuenta ha de arrastrarse al registro del jugador correspondiente. Naturalmente, si se opta por esquemas separados, entonces se complica un poco el mantenimiento de la integridad, pero se puede resolver fácilmente dando de alta al jugador en el momento de que se subscriba a cada juego. Los identificadores que identifican a cada registro de cada tabla no suelen cambiarse nunca, por lo que la integridad quedará garantizada a partir de ese momento. Los procesos de baja se realizan normalmente desactivando las cuentas, no borrándolas físicamente.

**Personaje** es cada uno de los avatares con los que cuenta un jugador. Es normal, y bastante deseable, que se puedan crear varios de ellos para poder disfrutar así del juego desde perspectivas distintas, aumentando además la vida útil del mismo. La información asociada a cada personaje es la que se selecciona en el momento de darlo de alta, como el nombre, género, raza, o clase a la que pertenece. El resto de atributos dependerá del tipo de juego y de las posibilidades que ofrezca este, como su ubicación actual, los puntos de salud, algún tipo de _karma_, el dinero disponible, los objetos del inventario, las zonas visitadas, o las misiones en curso o completadas, por ejemplo.

La gestión de personajes, y de hecho la gestión de cualquier entidad, puede hacerse con un diseño tremendamente abierto que permita asociarles cualquier tipo de atributo mediante el uso de tablas genéricas, como "tipo de atributos", "atributos", "valores de atributos", y "relaciones entre valores de atributos y personajes". La ventaja de este enfoque es que permite añadir cualquier tipo de atributo a un personaje sin cambiar el modelo, pero presenta serios inconvenientes, como el hecho de que resulta difícil de gestionar, al quedar distribuida la información por muchos registros en vez de en uno sólo, como ocurre en un diseño más tradicional, donde hay una sola tabla y se van añadiendo columnas para cada atributo que se necesite.
